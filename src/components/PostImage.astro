---
import { Image } from 'astro:assets';

import PostImageCaption from './PostImageCaption.astro';

export interface Props {
  src?: ImageMetadata;
  key?: string;
  alt: string;
  caption?: string;
  maxWidth?: string;
  class?: string;
  showCaption?: boolean;
  width?: number;
  height?: number;
}

const {
  src,
  key,
  alt,
  maxWidth = '600px',
  class: className,
  showCaption = true,
  width,
  height,
  ...rest
} = Astro.props;
---

<figure class={`flex flex-col items-center max-w-sm sm:max-w-xl mx-auto ${className || ''}`}>
  <Image
    src={(key as string) ?? (src as ImageMetadata)}
    alt={alt}
    style={`max-width: ${maxWidth}; height: auto; object-fit: contain;`}
    class="block h-auto w-full rounded-lg"
    width={width ?? 1200}
    height={height ?? 800}
    inferSize
    {...rest}
  />
  {showCaption && <PostImageCaption caption={rest.caption ?? alt} />}
</figure>
