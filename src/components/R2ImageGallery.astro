---
import PostImageGallery from './PostImageGallery.astro';
import type { GalleryImage } from './PostImageGallery.astro';

export interface Props {
  images: GalleryImage[];
  alt?: string;
  columns?: number;
  gap?: string;
  maxWidth?: string;
  showCaptions?: boolean;
  class?: string;
}

let { images } = Astro.props;
const { ...rest } = Astro.props;

const CLOUDFLARE_R2_URL = import.meta.env.CLOUDFLARE_R2_URL;

if (!CLOUDFLARE_R2_URL) {
  throw new Error('CLOUDFLARE_R2_URL environment variable is not set.');
}

// Construct the full image URL
images = images.map((image) => ({
  ...image,
  key: image.key ? `${CLOUDFLARE_R2_URL}/${image.key}` : undefined
}));
---

<PostImageGallery {...rest} images={images} />
