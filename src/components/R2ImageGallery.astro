---
import PostImageGallery from './PostImageGallery.astro';
import type { GalleryImage } from './PostImageGallery.astro';

export interface Props {
  images: GalleryImage[];
  alt?: string;
  columns?: number;
  gap?: string;
  maxWidth?: string;
  showCaptions?: boolean;
  class?: string;
}

let { images } = Astro.props;
const { ...rest } = Astro.props;

const R2_PUBLIC_URL = import.meta.env.CLOUDFLARE_PUBLIC_R2_URL;

if (!R2_PUBLIC_URL) {
  throw new Error(
    'PUBLIC_R2_URL environment variable is not set. Please add it to your .env file.'
  );
}

// Construct the full image URL
images = images.map((image) => ({
  ...image,
  key: image.key ? `${R2_PUBLIC_URL}/${image.key}` : undefined
}));
---

<PostImageGallery {...rest} images={images} />
