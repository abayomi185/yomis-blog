<!DOCTYPE html>
<html lang="en">
  <a name="top"></a>
  <!-- Referral to move to top of page -->
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>SFF Server PC &#8211; Yomi's Blog</title>
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link rel="dns-prefetch" href="//maxcdn.bootstrapcdn.com">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="New and improved Server Build now on an x86 Platform">
    <meta name="twitter:card" content="summary"></meta>
    <meta name="twitter:image:src" content="https://yomis.blog/_img/serverpc/network-diagram-close.jpg">
    <link rel="manifest" type="application/manifest+json; charset=utf-8" href="/yomis-blog/manifest.json" />
    <meta name="robots" content="all">
    <meta name="author" content="Abayomi Ikuru">
    
    <meta name="keywords" content="projects">
    <link rel="canonical" href="http://abayomi185.github.io/yomis-blog/server-pc">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for Yomi's Blog" href="/yomis-blog/feed.xml" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/yomis-blog/css/pixyll.css?202108151334" type="text/css">

    <!-- Swiper CSS -->
    <link rel="stylesheet" href="/yomis-blog/css/swiper-bundle.min.css">

    <!-- Yomi's Custom CSS -->
    <link rel="stylesheet" href="/yomis-blog/css/custom.css">

    <!-- Fonts -->
    
    <link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
    
    
      <link href="//maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
    

    <!-- MathJax -->
    

    <!-- Verifications -->
    
    

    <!-- Open Graph -->
    <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="SFF Server PC">
    <meta property="og:description" content="A blog for my tech related projects">
    <meta property="og:url" content="http://abayomi185.github.io/server-pc">
    <meta property="og:site_name" content="Yomi's Blog">
    
    <meta property="og:image" content="http://abayomi185.github.io/images/me.jpeg">
    

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    
    <meta name="twitter:title" content="SFF Server PC" />
    <meta name="twitter:description" content="New and improved Server Build now on an x86 Platform" />
    <meta name="twitter:url" content="http://abayomi185.github.io/server-pc" />
    
    <meta name="twitter:image" content="http://abayomi185.github.io/images/me.jpeg" />
    

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="/yomis-blog/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/yomis-blog/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/yomis-blog/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/yomis-blog/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/yomis-blog/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/yomis-blog/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/yomis-blog/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/yomis-blog/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/yomis-blog/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/yomis-blog/favicon-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/yomis-blog/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="/yomis-blog/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/yomis-blog/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/yomis-blog/favicon-32x32.png" sizes="32x32">
    <link rel="shortcut icon" href="/yomis-blog/favicon.ico">

    
</head>

<body class="site animated fade-in-down">
  
	

  <div class="site-wrap">
    <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="/yomis-blog/" class="site-title">Yomi's Blog</a>
      <nav class="site-nav">
        



    
    
    
    
        <a class="nav-link" href="/yomis-blog/about/">about-me</a>
    
    

    
    
    
    
        <a class="nav-link" href="/yomis-blog/contact/">say-hello</a>
    
    

      </nav>
      <div class="clearfix"></div>
      
        <div class="social-icons">
  <div class="social-icons-right">
    
    
      <a class="fa fa-github" href="https://github.com/abayomi185"></a>
    
    
    
    
    
    
    
    
    <a class="fa fa-linkedin" href="https://www.linkedin.com/in/abayomi-o-ikuru"></a>
    
    
    <a class="fa fa-rss" href="/yomis-blog/feed.xml"></a>
    
    
    
    
    
      <a class="fa fa-paypal" href="https://paypal.me/yomitosh"></a>
    
  </div>
  <div class="right">
    
    
    
  </div>
</div>
<div class="clearfix"></div>

      
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap" role="main">
      <div class="measure">
        <!-- First Content Div on the rendered page -->
        


<div class="post-header mb2">
  <h1>SFF Server PC</h1>
  <!-- This h1 tag takes the "title" key value from the posts passed into this template  -->
  <span class="post-meta">Dec 18, 2020</span><br>
  
  <span class="post-meta small">
  
    4 minute read
  
  </span>
</div>

<article class="post-content">
  <p style="text-align: center;"><img src="/yomis-blog/_img/serverpc/serverpc.jpg" alt="" class="medium-post-img" /></p>

<p>Having tested the waters with <a href="/piserver">PiServer</a> (Raspberry pi 4 powered NAS/Server), I thought I could use a step up, to experiment with ‘bigger toys’ similar to those used in a professional setting; an <strong>x86 platform</strong>.</p>

<blockquote>
  <p>One of the main aims for this project was to successfully run Windows 10 in a virtual machine using KVM(Kernel-based Virtual Machine) to run games as well as improve my knowledge on virtualisation. This PC is a linux based machine that I would go on to use for; cryptocurrency mining, linux kernel compilation, more containerised applications, reverse proxy servers and more.</p>
</blockquote>

<h2 id="hardware">Hardware</h2>

<p>Staying true to the <strong>small form factor (SFF)</strong> of PiServer, I looked to accomplish something very similar with this new build. The <a href="https://www.reddit.com/r/sffpc">r/sffpc</a> subreddit was a great source as well as <a href="https://www.youtube.com/channel/UCRYOj4DmyxhBVrdvbsUwmAA">Optimum Tech</a> on YouTube detailing the things to look out for when purchasing and building a small form factor PC.</p>

<hr />
<p style="text-align: center;">Here’s a <a href="https://docs.google.com/spreadsheets/d/1AddRvGWJ_f4B6UC7_IftDiVudVc8CJ8sxLUqlxVsCz4/edit#gid=1885868234">spreadsheet</a> created by Redditor <a href="https://www.reddit.com/r/sffpc/comments/e878ha/sff_case_list/">u/prayogahs</a> that helped a lot.</p>
<hr />

<p>I opted for the <a href="https://www.aliexpress.com/item/10000218146300.html">Metalfish S3 plus</a> and the rest of the specs are as follows;</p>

<ul>
  <li>Intel i5-10400 6 Cores / 12 Threads CPU</li>
  <li>Alpenfohn Black Ridge CPU Cooler</li>
  <li>32GB 2666MHz Corsair Vengeance LPX DDR4 RAM</li>
  <li>Radeon 5500XT GPU</li>
  <li>ASUS ROG H470-I Gaming Motherboard</li>
  <li>Corsair SF450 PSU 80+ Gold</li>
  <li>240GB M.2 SATA SSD</li>
  <li>500GB 2.5” SATA SSD</li>
  <li>2TB 2.5” HDD</li>
</ul>

<!-- Slide show if images here -->
<p><br /></p>
<p align="center" style="text-align: center;">
<iframe width="560" height="350" src="https://www.youtube.com/embed/e5DTeG9-QMM" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" style="width: 85%;">
</iframe>
</p>

<h2 id="software">Software</h2>
<p>I opted to use <a href="https://linuxmint.com">Linux Mint</a> as my base OS after a lot of research and indecisiveness. My reasons were; it is based on Ubuntu which is very popular and documentation is plentiful and it runs Cinnamon DE (Desktop Environment) which I find mostly pleasing perhaps due to its similarities with Windows (I have yet to try out a Window Tiling Manager). I tested a number of other distros (Linux Distributions) including Arch with KDE Plasma DE which I ultimately decided against as I wanted the server PC to be as stable as a rock.</p>

<p>Fast forward onto the super interesting and time consuming part of this setup, after tweaking fan curves for whisper silence, upgrading from 16GB to 32GB RAM and setting up Samba and Docker as it was on PiServer. It was time to set up Windows and macOS in a virtual machine using KVM.</p>

<hr />
<p style="text-align: center;">Kernel-based Virtual Machine (KVM) - <a href="https://en.wikipedia.org/wiki/Kernel-based_Virtual_Machine">wiki</a></p>
<hr />

<p>I discovered KVM, a Type 1 <a href="https://en.wikipedia.org/wiki/Hypervisor">Hypervisor</a> by watching, <a href="https://www.youtube.com/user/SomeOrdinaryGamers">SomeOrdinaryGamers</a> on YouTube and I was so intrigued by the capabilities and security benefits from running a virtual machine. KVM is special because as it says in its name, it virtualises at the kernel level which does wonders for performance in VMs and best of all, GPU’s and other peripherals can be <strong>“passed”</strong> to the VM effectively making the VM have full control of PCIe devices and other devices as it would if it were running bare metal (not under a VM).</p>

<p style="text-align: center;"><img src="/yomis-blog/_img/serverpc/virt-manager.png" alt="" class="medium-post-img" />
<br /><small>Virt-Manager UI for KVM</small></p>

<h4 id="windows-vm">Windows VM</h4>
<p>Installing Windows 10 was easy enough using multiple guides and the very detailed <a href="https://wiki.archlinux.org/index.php/PCI_passthrough_via_OVMF">Arch documentation</a>. As a disclaimer, Arch uses a slightly different configuration process to most ubuntu based distros, so your search may need to be specific. This guide by Mathias Hueber made setting it up on Linux Mint simple, <a href="https://mathiashueber.com/pci-passthrough-ubuntu-2004-virtual-machine/">PCI Passthrough Guide</a>.</p>

<h4 id="macos-vm">macOS VM</h4>
<p>Installing macOS is different to say the least and compatibility is inconsistent across different hardware, although less of an issue for a basic setup in a virtual machine. I followed the guide by Kholia, <a href="https://github.com/kholia/OSX-KVM">OSX-KVM</a> which uses OpenCore as opposed to Clover, with the general consensus being OpenCore has a better future.</p>

<p>A tip, if you’re having issues with OpenCore GPU Passthrough; I mounted the OpenCore-Passthrough.qcow2 image and added ‘agdpmod=pikera’ to boot-args in the OpenCore config.plist, to get GPU Passthrough to work with my Radeon Card (Nvidia graphics cards are not supported in macOS versions past High Sierra).</p>

<p><br /></p>
<p style="text-align: center;"><img src="/yomis-blog/_img/serverpc/network-diagram.png" alt="" class="xlarge-post-img" />
<br /><small>Home Lab Network Diagram</small></p>

<h2 id="conclusion">Conclusion</h2>
<p>I didn’t go into the nuances I stumbled on with this setup as they kept me up for many nights and I would prefer not to but if you come across any issues, I would love to help out, granted I’m no expert. The <a href="https://www.reddit.com/r/VFIO/">r/VFIO</a> subreddit and discord have loads of helpful information too. And if you didn’t already know, reading error logs help a ton.</p>

<p>I do want to mention that going with a Radeon GPU prior the new generation GPUs (Big Navi), you will most likely face the radeon “PCIe Reset Bug”, which now has a <a href="https://github.com/gnif?tab=repositories">fix</a> from Geoffrey McRae with Reddit username <a href="https://www.reddit.com/user/gnif2">gnif2</a> that doesn’t require recompiling the linux kernel anymore (I had fun compiling the linux kernel though).</p>

<hr />
<p style="text-align: center;">I’ve gone ahead to do a lot more with this build that I’ll document at a later date, cryptocurrency mining with hiveOS being one of them. I have learned a lot from doing all of this, I urge you to give it a go if you are considering building a similar setup.</p>
<hr />

</article>


  <div class="share-page">
  Share this post!

  <div class="share-links">
    
      <a class="fa fa-facebook" href="https://facebook.com/sharer.php?u=http%3A%2F%2Fabayomi185.github.io%2Fserver-pc" rel="nofollow" target="_blank" title="Share on Facebook"></a>
    

    
      <a class="fa fa-twitter" href="https://twitter.com/intent/tweet?text=SFF+Server+PC&amp;url=http%3A%2F%2Fabayomi185.github.io%2Fserver-pc" rel="nofollow" target="_blank" title="Share on Twitter"></a>
    

    

    
      <a class="fa fa-linkedin" href="http://www.linkedin.com/shareArticle?url=http%3A%2F%2Fabayomi185.github.io%2Fserver-pc&amp;title=SFF+Server+PC" rel="nofollow" target="_blank" title="Share on LinkedIn"></a>
    

    

    

    

    

    
  </div>
</div>






  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname  = 'yomisblog';
    var disqus_identifier = '/SFF-Server-PC';
    var disqus_title      = "SFF Server PC";

    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <!-- Place this tag in your head or just before your close body tag. -->
  <script async defer src="https://buttons.github.io/buttons.js"></script>






      </div>
    </div>
  </div>

  <footer class="center">
  <div class="measure">
    <small>
      <!-- Theme crafted with &lt;3 by <a href="http://johnotander.com">John Otander</a> (<a href="https://twitter.com/4lpine">@4lpine</a>).<br>
      &lt;/&gt; available on <a href="https://github.com/johnotander/pixyll">GitHub</a>. -->
      Yomi's Blog tweaked and adapted from <a href="https://github.com/johnotander/pixyll">Pixyll</a>.<br>
      <a href="#top">Social Links</a> at the top ;)
    </small>
  </div>
</footer>

<script type="text/javascript">
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("/yomis-blog/sw.js")
    }
</script>

<!-- Swiper JS -->
<script src="/yomis-blog/js/swiper-bundle.min.js" type="text/javascript"></script>

<!-- shoppy.gg -->
<script src="https://shoppy.gg/api/embed.js"></script>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

<!-- Yomi's Custom JS -->
<script src="/yomis-blog/js/custom.js" type="text/javascript"></script>
</body>
</html>
